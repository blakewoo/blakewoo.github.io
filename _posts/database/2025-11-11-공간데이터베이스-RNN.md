---
title: 공간 데이터 베이스 - RNN(Reverse nearest neighbor)
author: blakewoo
date: 2025-11-11 23:00:00 +0900
categories: [Database]
tags: [Computer science, Database, Spacial Database, RNN]
render_with_liquid: false
use_math: true
---

# RNN(Reverse nearest neighbor)
## 1. 개요
RNN은 Query q에 대해 어떤 점 p가 p의 최근접이 q인 경우 p를 q의 역최근접 이웃으로 간주하는 개념으로,
직관적으로 q가 특정 점들의 NN이 되는 집합을 찾는 문제를 말한다.

q의 가장 최근접이 p일 때 q 역시 p의 가장 최근접이 아닌가 하고 그냥 언뜻 생각하면 그렇게 생각할 수 있지만
꼭 역이 성립하지는 않는다.

![img.png](/assets/blog/database/spacial_database/rnn/img.png)

위와 같은 경우에는 q의 가장 최근접 이웃은 p이지만 p의 최근접 이웃은 s이다.

## 2. Precomputing
### 1) KM00
KORN과 Muthukrishnan이 00년도에 냈다고 KM00이라고 붙은 것 같다.   
이 방법을 정리하자면 굉장히 간단하다.

모든 데이터점 p에 대해 NN(p)을 사전 계산하고 이를 기반으로 p의 근방을 원(비서티 원)으로 표현한 뒤,
모든 원의 MBR을 R-tree(RNN-tree)에 색인하여 q를 포함하는 원들의 집합을 RNN(q)로 반환한다.
두 개의 트리(RNN-tree와 데이터 R-tree)가 필요하다는 점이 구현·유지 비용으로 작용한다.

### 2) YL01
Congjun Yang과 King-Ip Lin이 01년도에 만들었다고 YL01이다.   
KM00과 같이 별도의 RNN-tree를 유지하는 것까지는 같으나 구조가 다르다.

논문이 제안하는 RdNN-tree는 잎 노드에 각 데이터점 p의 비서티 원(중심 p, 반경 = NN(p)까지의 거리)을 저장하고,
내부 노드는 하위 원들의 최소 경계 사각형(MBR)들을 보관한다.
이렇게 하면 질의 시 점 위치 질의를 통해 q를 포함할 수 있는 원들의 후보 집합을 신속히 결정할 수 있으며,
원의 유지·갱신도 R-tree 연산으로 처리 가능하다.

## 3. Filter/refinement
### 1) SAA
질의점을 중심으로 공간을 6개 등각 영역으로 분할하고 각 영역에서 NN(q)를 찾아 후보를 모은 뒤,
각 후보 p에 대해 p가 RNN(q)이거나 해당 영역에 RNN이 존재하지 않음을 이용해 거르도록 한다.
그러나 차원이 증가하면 영역 수가 기하급수적으로 늘어 고차원에서 비효율적이다.

### 2) SFT
먼저 kNN(q)을 후보로 수집하고, 후보들끼리의 상대적 근접성으로 일부를 제거한 뒤 불리언 범위 질의로 실제 RNN을 판별한다.
불리언 범위 질의는 첫 데이터점을 찾거나 노드 MBR 한 변 전체가 원 안에 들어오면 조기 종료되지만,
k 선택에 민감하며 k가 작을 경우 실제 답을 놓치는 거짓 누락이 발생할 수 있다.

## 4. Single RNN
## 5. TPL
> ※ 추가 업데이트 및 검증 예정이다.
{: .prompt-tip }

# 참고자료
- Shashi Shekhar and Sanjay Chawla, Spatial Databases: A Tour, Prentice Hall, 2003
- P. RIigaux, M. Scholl, and A. Voisard, SPATIAL DATABASES With Application to GIS, Morgan Kaufmann Publishers, 2002
- Korn, Flip, and S., Muthukrishnan. "Influence sets based on reverse nearest neighbor queries." . In Proceedings of the 2000 ACM SIGMOD International Conference on Management of Data (pp. 201–212). Association for Computing Machinery, 2000.
- Tao, Yufei, Dimitris, Papadias, and Xiang, Lian. "Reverse kNN search in arbitrary dimensionality." . In Proceedings of the Thirtieth International Conference on Very Large Data Bases - Volume 30 (pp. 744–755). VLDB Endowment, 2004.

