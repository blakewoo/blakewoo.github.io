---
title: 통계학 - 통계적 추론 - 가설검정
author: blakewoo
date: 2024-10-02 22:00:00 +0900
categories: [Statistics]
tags: [Statistics, Math]
render_with_liquid: false
use_math: true
---

# 통계적 가설검정

## 1. 가설
아직 증명되지 않은 문제에 대하여 문장으로 설정한 것

## 2. 통계적 가설
가설의 참과 거짓을 귀납법, 연역법으로 증명할 수 없고 관련된 통계 자료를 이용하여
가장 가능성이 높은 결론을 내리고자 하는 것.

## 3. 통계적 가설 검정 절차

### 1) 귀무가설과 대립가설을 세운다.
$H_{0}$ : 부정하고 싶은 문장 (귀무가설 : null hypothesis)   
$H_{1}$ : 주장하고 싶은 문장 (대립가설 : alternative hypothesis)   
$\Rightarrow H_{0} : \mu = 10 vs H_{1} : \mu > 10$
### 2) 검정통계량을 선택한다.
검정통계량(test statistic) : 귀무가설의 기각 여부를 결정하는데 사용되는 통계량    
$\Rightarrow$ 연비의 참 값 $\mu$에 대한 점 추정치로 표본평균 $\overline{X}$를 사용하는 것이 타당

### 3) 기각역을 설정한다.
기각역(rejection region) : 귀무가설이 기각되는 영역
$\Rightarrow$ 어떤 값 c에 대하여 $\overline{X}$ > c 이면 $H_{0}$을 기각함. 여기서 c는 기각치(critical value)라고 한다.

## 4. 통계쩍 가설 검정 진리표
<table>

<tbody>
<tr>
<td rowspan="2">표본에 의한 결정</td><td colspan="2">미지의 실제 상황</td>
</tr>
<tr>
<td>$H_{0}$ 참<br>($\mu$ = 10)</td><td>$H_{1}$ 참<br>($\mu$ > 10)</td>
</tr>
<tr>
<td>$H_{0}$ 기각</td><td>$H_{0}$을 잘못 기각함<br>(제 1종 오류)</td><td>옳은 결정</td>
</tr>
<tr>
<td>$H_{0}$ 채택</td><td>옳은 결정</td><td>$H_{0}$을 잘못 채택함<br>(제 2종 오류)</td>
</tr>
</tbody>
</table>


- $\alpha$ : 제 1종 오류를 범할 확률 (유의수준, level of significance)   
  $\Rightarrow$ 귀무가설이 맞음에도 불구하고 귀무가설을 기각하는 오류를 일으킬 확률

- $\beta$ : 제 2종 오류를 범할 확률   
  $\Rightarrow$ 귀무가설이 틀림에도 불구하고 귀무가설을 기각하지 않는 오류를 일으킬 확률

- $1-\beta$ : 검정력(power of test)


## 5. 최적의 가설 검정
$\alpha$와 $\beta$를 최소화 시키는 검정법, 단 자료의 크기 n이 정해져있다면 $\alpha$와 $\beta$를 모두 최소화 하는 것은 불가능
따라서 가능한 최적의 검정법은 $\alpha$를 작은 값(흔히 0.01, 0.05 또는 0.1)으로 고정시킨 후 검정력(1-$\beta$)을 최대화 시킴

## 6. 기각역 산출법
유의 수준 $\alpha$가 주어졌을 때 기각역을 계산하는 방법은 귀무가설 하에서 검정 통계량의 분포를 구한 다음 유의수준에 맞는 기각역을 결정하는 것이다.

아래의 식을 보자, 대립가설 $H_{1}$을 $\mu > \mu _{0}$, 귀무가설 $H_{0}$을 $\mu = \mu _{0}$이라고 하고
(여기서 $\mu _{0}$는 주장하고 싶은 값이다)   
유의수준을 $\alpha$ㅡ 기각역을 c라고 할때 해당 값을 구하는 식은 아래와 같다.

$$\alpha = P[\overline{X}>c]$$

다음식에 따르면 해당 유의수준은 구하고자하는 기댓값이 c값보다 클 확률이다.
대표본의 경우 중심극한정리에 의해 정규분포로 바꾸는 표준화가 가능하므로 아래와 같이 바꿀 수 있다.

$$P[\frac{\overline{X}-\mu}{\sigma / \sqrt{n}}>\frac{c-\mu}{\sigma / \sqrt{n}}] = P[Z>z_{\alpha}]$$

그러면 $Z_{\alpha}$에 대해서 다음과 같이 바꿀 수 있다.

$$z_{\alpha} = \frac{c-\mu}{\sigma / \sqrt{n}}$$

이 수식을 c에 대해서 전개하면

$$c = z_{\alpha} (\frac{\sigma}{\sqrt{n}})+\mu$$

과 같이 나타난다.

## 7. 귀무가설의 대립 가설 종류
귀무가설 $H_{0} : \mu = \mu _{0}$에 대하여 3가지 형태의 대립가설이 가능하며   
그에 따른 기각역의 형태는 다음과 같이 요약 할 수 있음. (단, 여기서 $$Z = \frac{\overline{X}-\mu_{0}}{s/\sqrt{n}}$$이고 대표본을 가정)

<table>
<thead>
<tr>
<td>귀무가설</td><td>대립가설</td><td>기각역</td><td>비고</td>
</tr>
</thead>
<tbody>
<tr>
<td>$H_{0} : \mu = \mu _{0}$</td><td>$H_{1} : \mu > \mu _{0}$</td><td>$Z > Z_{\alpha}$</td><td>단측검정</td>
</tr>
<tr>
<td>$H_{0} : \mu = \mu _{0}$</td><td>$H_{1} : \mu < \mu _{0}$</td><td>$Z < Z_{\alpha}$</td><td>단측검정</td>
</tr>
<tr>
<td>$H_{0} : \mu = \mu _{0}$</td><td>$H_{1} : \mu \neq \mu _{0}$</td><td>$|Z| > Z_{\alpha}$</td><td>양측검정</td>
</tr>
</tbody>
</table>

※ 참고
대표본 가정 하에서 모평균 $\mu$에 대한 100(1-$\alpha$)% 근사적 신뢰구간은   
$$\overline{X} \pm Z_{\alpha/2}\frac{s}{\sqrt{n}}$$   
이고 이는 유의수준 $\alpha$에서 양측검정   
$$H_{0} : \mu = \mu _{0}\; vs\; H_{1} : \mu \neq \mu _{0}$$   
에 대한 채택역 (acceptance region, 기각역의 여사건)과 같게 됨.

## 8. 유의 확률 
주어진 검정 통계량을 기각시키기 위한 제 1종 오류의 최소값이다.

- 유의 확률이 작을 수록 귀무가설을 기각할 수 있는 정당성이 커진다.
- 주어진 유의수준 $\alpha$에서 귀무가설이 기각 $\Rightarrow$ 유의확률 < 유의수준
- 주어진 유의수준 $\alpha$에서 귀무가설이 채택 $\Rightarrow$ 유의확률 > 유의수준

※ 참고
- 0.05<p-value<0.1 : 유의함 (significant)*
- 0.01<p-value<0.05 : 매우 유의함 (highly significant)**
- p-value<0.01 : 매우 강력하게 유의함 (highly strongly significant) ***


# 참고자료
- [R을 이용한 통계학 개론](https://www.kmooc.kr/view/course/detail/5086?tm=20240914182522)
