---
title: 통계학 - 통계적 추론 - 가설검정
author: blakewoo
date: 2024-10-02 22:00:00 +0900
categories: [Statistics]
tags: [Statistics, Math]
render_with_liquid: false
use_math: true
---

# 통계적 가설검정

## 1. 가설
아직 증명되지 않은 문제에 대하여 문장으로 설정한 것

## 2. 통계적 가설
가설의 참과 거짓을 귀납법, 연역법으로 증명할 수 없고 관련된 통계 자료를 이용하여
가장 가능성이 높은 결론을 내리고자 하는 것.

## 3. 통계적 가설 검정 절차

### 1) 귀무가설과 대립가설을 세운다.
$H_{0}$ : 부정하고 싶은 문장 (귀무가설 : null hypothesis)   
$H_{1}$ : 주장하고 싶은 문장 (대립가설 : alternative hypothesis)   
$\Rightarrow H_{0} : \mu = 10\; vs\; H_{1} : \mu > 10$
### 2) 검정통계량을 선택한다.
검정통계량(test statistic) : 귀무가설의 기각 여부를 결정하는데 사용되는 통계량    
$\Rightarrow$ 연비의 참 값 $\mu$에 대한 점 추정치로 표본평균 $\overline{X}$를 사용하는 것이 타당

### 3) 기각역을 설정한다.
기각역(rejection region) : 귀무가설이 기각되는 영역
$\Rightarrow$ 어떤 값 c에 대하여 $\overline{X}$ > c 이면 $H_{0}$을 기각함. 여기서 c는 기각치(critical value)라고 한다.

## 4. 통계쩍 가설 검정 진리표
<table>

<tbody>
<tr>
<td rowspan="2">표본에 의한 결정</td><td colspan="2">미지의 실제 상황</td>
</tr>
<tr>
<td>$H_{0}$ 참<br>($\mu$ = 10)</td><td>$H_{1}$ 참<br>($\mu$ > 10)</td>
</tr>
<tr>
<td>$H_{0}$ 기각</td><td>$H_{0}$을 잘못 기각함<br>(제 1종 오류)</td><td>옳은 결정</td>
</tr>
<tr>
<td>$H_{0}$ 채택</td><td>옳은 결정</td><td>$H_{0}$을 잘못 채택함<br>(제 2종 오류)</td>
</tr>
</tbody>
</table>


- $\alpha$ : 제 1종 오류를 범할 확률 (유의수준, level of significance)   
  $\Rightarrow$ 귀무가설이 맞음에도 불구하고 귀무가설을 기각하는 오류를 일으킬 확률

- $\beta$ : 제 2종 오류를 범할 확률   
  $\Rightarrow$ 귀무가설이 틀림에도 불구하고 귀무가설을 기각하지 않는 오류를 일으킬 확률

- $1-\beta$ : 검정력(power of test)


## 5. 최적의 가설 검정
$\alpha$와 $\beta$를 최소화 시키는 검정법, 단 자료의 크기 n이 정해져있다면 $\alpha$와 $\beta$를 모두 최소화 하는 것은 불가능
따라서 가능한 최적의 검정법은 $\alpha$를 작은 값(흔히 0.01, 0.05 또는 0.1)으로 고정시킨 후 검정력(1-$\beta$)을 최대화 시킴

## 6. 기각역 산출법
유의 수준 $\alpha$가 주어졌을 때 기각역을 계산하는 방법은 귀무가설 하에서 검정 통계량의 분포를 구한 다음 유의수준에 맞는 기각역을 결정하는 것이다.

아래의 식을 보자, 대립가설 $H_{1}$을 $\mu > \mu _{0}$, 귀무가설 $H_{0}$을 $\mu = \mu _{0}$이라고 하고
(여기서 $\mu _{0}$는 주장하고 싶은 값이다)   
유의수준을 $\alpha$ㅡ 기각역을 c라고 할때 해당 값을 구하는 식은 아래와 같다.

$$\alpha = P[\overline{X}>c]$$

다음식에 따르면 해당 유의수준은 구하고자하는 기댓값이 c값보다 클 확률이다.
대표본의 경우 중심극한정리에 의해 정규분포로 바꾸는 표준화가 가능하므로 아래와 같이 바꿀 수 있다.

$$P[\frac{\overline{X}-\mu}{\sigma / \sqrt{n}}>\frac{c-\mu}{\sigma / \sqrt{n}}] = P[Z>z_{\alpha}]$$

그러면 $Z_{\alpha}$에 대해서 다음과 같이 바꿀 수 있다.

$$z_{\alpha} = \frac{c-\mu}{\sigma / \sqrt{n}}$$

이 수식을 c에 대해서 전개하면

$$c = z_{\alpha} (\frac{\sigma}{\sqrt{n}})+\mu$$

과 같이 나타난다.

## 7. 귀무가설의 대립 가설 종류
귀무가설 $H_{0} : \mu = \mu _{0}$에 대하여 3가지 형태의 대립가설이 가능하며   
그에 따른 기각역의 형태는 다음과 같이 요약 할 수 있음. (단, 여기서 $$Z = \frac{\overline{X}-\mu_{0}}{s/\sqrt{n}}$$이고 대표본을 가정)

<table>
<thead>
<tr>
<td>귀무가설</td><td>대립가설</td><td>기각역</td><td>비고</td>
</tr>
</thead>
<tbody>
<tr>
<td>$H_{0} : \mu = \mu _{0}$</td><td>$H_{1} : \mu > \mu _{0}$</td><td>$Z > Z_{\alpha}$</td><td>단측검정</td>
</tr>
<tr>
<td>$H_{0} : \mu = \mu _{0}$</td><td>$H_{1} : \mu < \mu _{0}$</td><td>$Z < Z_{\alpha}$</td><td>단측검정</td>
</tr>
<tr>
<td>$H_{0} : \mu = \mu _{0}$</td><td>$H_{1} : \mu \neq \mu _{0}$</td><td>$|Z| > Z_{\alpha}$</td><td>양측검정</td>
</tr>
</tbody>
</table>

※ 참고
대표본 가정 하에서 모평균 $\mu$에 대한 100(1-$\alpha$)% 근사적 신뢰구간은   
$$\overline{X} \pm Z_{\alpha/2}\frac{s}{\sqrt{n}}$$   
이고 이는 유의수준 $\alpha$에서 양측검정   
$$H_{0} : \mu = \mu _{0}\; vs\; H_{1} : \mu \neq \mu _{0}$$   
에 대한 채택역 (acceptance region, 기각역의 여사건)과 같게 됨.

## 8. 유의 확률 
주어진 검정 통계량을 기각시키기 위한 제 1종 오류의 최소값이다.

- 유의 확률이 작을 수록 귀무가설을 기각할 수 있는 정당성이 커진다.
- 주어진 유의수준 $\alpha$에서 귀무가설이 기각 $\Rightarrow$ 유의확률 < 유의수준
- 주어진 유의수준 $\alpha$에서 귀무가설이 채택 $\Rightarrow$ 유의확률 > 유의수준

※ 참고
- 0.05<p-value<0.1 : 유의함 (significant)*
- 0.01<p-value<0.05 : 매우 유의함 (highly significant)**
- p-value<0.01 : 매우 강력하게 유의함 (highly strongly significant) ***


## ※ 연습문제1
어느 다이어트 프로그램에서 5주 동안 22파운드 이상의 몸무게를 줄인다고 광고한다.    
50명이 참가하여 5주동안 이 프로그램을 수행한 결과 감소한 몸무게는 평균 $\overline{X}$ = 23.5파운드, 표준편차 s = 10.2 파운드로 나타났다.
이 다이어트 프로그램의 광고는 믿을 만 한가?   
유의수준 $\alpha = 0.05$에서 검정하고 p-value를 계산하라.

### ※ 해답
- 귀무가설 : $H_{0} : \mu = 22$  
- 대립가설 : $H_{1} : \mu > 22$

검정통계량 : $z = \frac{\overline{X}-\mu _{0}}{s/\sqrt{n}} = \frac{23.5-22}{10.2/\sqrt{50}} = 1.0399$    
기각역 : $z>z_{\alpha}, z_{\alpha}=1.645$    
$\Rightarrow$ 유의수준 0.05에서 귀무가설을 기각 할 수 없다.

p-value는 표준정규분포표에서 1.0399를 찾게되면 0.8508068이 나오는데 단측 검정이므로 1-0.8508068을 하면 약 0.1492가 나온다.
따라서 p-value는 0.1492이다. 

## ※ 연습문제2
토종 잣의 평균 길이는 1.9cm라고 알려져 있다.   
수입 잣 40개의 길이를 잰 결과 평균 $\overline{X} = 1.715$, 표준편차 s=0.475로 나타났다.   
수입잣은 토종 잣과 길이가 같다고 할 수 있는가?   
유의 수준 $\alpha=0.05$에서 검정하고 유의확률을 구하라.

### ※ 해답
- 귀무가설 : $H_{0} : \mu = 1.9$
- 대립가설 : $H_{1} : \mu \neq 1.9$

검정통계량 : $z = \frac{\overline{X}-\mu _{0}}{s/\sqrt{n}} = \frac{1.715-1.9}{0.475/\sqrt{40}} = -2.46$    
기각역 : $|z|>z_{\alpha/2}, z_{\alpha/2}=1.96$    
$\Rightarrow$ 유의수준 0.05에서 귀무가설을 기각 할 수 있다..

p-value는 양측검정이기 때문에 표준정규분포표에서 -2.46 값과 1에서 2.46 값을 빼준 값을 더해주면 된다.
r에서는 다음과 같이 입력하면 된다.
```
pnorm(-2.46)+(1-pnorm(2.46))
```
이렇게 구하면 p-value는 0.0138이다.

## ※ 연습문제3
식품 의약품 안전청에서는 어떤 생수의 단위량 당 세균의 평균 숫자가 안전수준인 200 이내인지를 조사하고자 한다.   
한 조사원이 10개의 표본자료를 검사한 결과 세균의 수는 다음과 같았다.   
```
175, 190, 215, 198, 184, 207, 210, 193, 196, 180   
```
이 자료에 의하면 이 생수는 안전하다고 볼 수 있는가? $\alpha=0.01$에서 검정하라.

### ※ 해답
- 귀무가설 : $H_{0} : \mu = 200$
- 대립가설 : $H_{1} : \mu < 200$

표본 10개의 평균을 구하면 $\overline{X} = 194.8$ 이 된다.
표본 분산 역시 $\sigma^{2} = 171.3889$가 되며
표본 표준편차를 구하기 위해 분산에 루트를 취해주면 $\sigma = 13.09$가 된다.    
그리고 자유도는 9이다.    
표본이 30개 이하이므로 스튜던트 t 분포를 사용한다.
스튜던트 t 분포에 대해서 표준화를 하면 아래와 같다.

$$t = \frac{\overline{X} - \mu}{\sigma / \sqrt{n}} = \frac{194.8-200}{13.09/\sqrt{10}} = -1.256$$

이때 귀무가설에 의해 기각되려면 $t<t_{\alpha}$여야하는데
$\alpha$의 경우 0.01이므로 자유도 9에서 student t가 0.01값은 -2.821이다.

이는 위에서 구한 -1.25 값보다 작은 값이므로 $\alpha = 0.01$에서 기각이 불가능하다. 


# 참고자료
- [R을 이용한 통계학 개론](https://www.kmooc.kr/view/course/detail/5086?tm=20240914182522)
