---
title: 부트로더 - 2
author: blakewoo
date: 2024-1-12 21:30:00 +0900
categories: [OS]
tags: [OS]
render_with_liquid: false
---

현대의 MBR은 다음 세가지로 이루어져야한다. 
## 1. Bootstrap Code   
파티션 테이블을 참조해서 관련 코드를 불러오는 코드다.

## 2. Partition Table Entry
### Boot Flag (1 Byte)   
0x80 -> 부팅 가능 코드   
0x00 -> 부팅 불가 코드 
### Starting CHS Address (3 Byte)
현재는 사용되지 않는 부분으로 파티션 시작 주소를 CHS 주소로 적은 부분이다.
### Partition Type (1 Byte)
파티션이 어떤 종류인지 명시해둔 코드이다.   
0x07 -> NTFS   
0x0B, 0x0C -> FAT32   
0x05, 0x06 -> Extended partition (확장 파티션)   
0x83 -> 리눅스 파티션  
0x82 -> 리눅스 스왑파티션 
### Ending CHS Address (3 Byte)   
현재는 사용되지 않는 부분으로 파티션 끝 주소를 CHS 주소로 적은 부분이다. 
### Starting LBA Address (4 Byte)   
현재도 쓰고 있는 부분으로 실제 파티션의 시작을 LBA 방식으로 기재해둔 곳이다.
### Size in Sector (4 Byte)   
섹터의 크기 (파티션의 총 섹터 갯수, 총 용량을 계산하려거든 512Bytes를 곱하면 된다.)   

## 3. Signature
512Bytes 끝에 0xAA, 0x55가 들어가있어야한다. 리틀엔디안일때 이렇게 들어가야하고, 빅엔디안의 경우
0x55, 0xAA순으로 들어가 있다.   
해당 시그니처가 없으면 MBR로 인식하지 않는다.

사실 2번인 Partiion Table Entry가 없어도 동작은 한다.
단지 BootStrap Code에서 어디부터 어디까지 가져와서 로딩할 것인지에 대한 부분을 다 정의해줘야하고
파일 시스템을 사용할 수 없다는 점에서는 좀 치명적이긴하지만, 구동자체는 가능하다.
그냥 현대의 OS가 이러한 형태라는 것이니까. 사실은 끝에 Signature만 제대로 지켜줘도
단일 운영체제 구동은 문제없다.


### 참고 문헌
1. 64Bit 멀티코어 OS의 구조 - 한승훈 저
