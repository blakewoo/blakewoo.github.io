---
title: 리눅스 - 가상 파일 시스템
author: blakewoo
date: 2024-12-29 20:40:00 +0900
categories: [Linux]
tags: [Computer science, Linux, OS] 
render_with_liquid: false
use_math: true
---

# 가상 파일 시스템(Virtual Filesystem)

## 1. 개요
가상 파일 시스템(Virtual Filesystem, 혹은 Virtual File Switch 라고도 한다)인 VFS는 파일시스템 관련 인터페이스를 사용자 공간
애플리케이션에 제공하고 파일을 구현하는 커널 서브 시스템이다. 모든 파일시스템은 VFS를 통해 공존이 가능할 뿐만 아니라 상호 동작도 가능하다.
요컨대 ext3 파일 시스템을 쓰는 하드 디스크와 ext2 파일 시스템을 사용하는 이동식 디스크라도 VFS를 통해 서로간에 데이터를 옮길 수 있다는 뜻이다.

VFS는 open(), write(), read() 같은 시스템 호출이 파일 시스템이나 물리적 매체의 종류와 상관없이 동작하게 해주는 역할을 한다.
이는 가상 인터페이스를 통해 파일 시스템에 접근하기 때문에 가능한 것으로 과거에는 이런 일이 불가했다.
어떻게 가능하게 되었을까?

이는 리눅스에서 커널이 하위 파일 시스템 인터페이스에 대한 추상화 계층을 제공하기 때문에 가능한 것이다.
리눅스에서 제공하는 기능과 동작이 다른 여러 파일 시스템을 이 추상화 계층을 통해 지원한다.
그렇기 때문에 다른 포맷으로 이루어진 파일 시스템에서 서로간의 데이터를 전달 할 수 있는 것이다.
이 모델은 파일 시스템 하부의 자세한 동작을 이해할 필요가 없게 만들어주었다.

![img.png](/assets/blog/linux/vfs/img.png)

하지만 우리는 VFS의 세세한 구조를 알아야하므로 좀 더 세부적으로 알아보겠다.

## 2. 유닉스 파일 시스템
기본적으로 VFS는 유닉스 스타일 파일 시스템에 편향된 디자인을 하고 있다. 따라서 우리가 VFS에 대해서 알아보기 위해서는
유닉스 파일 시스템 스타일을 알아야 한다.
역사적으로 유닉스에는 아래의 네 가지 추상화 개념이 있었다.

### 1) 마운트(mount)
유닉스에서 파일 시스템은 이름공간이라는 전역 계층 구조의 특정 지점에 부착(mount)된다. 이렇게 해서 모든 파일 시스템이 하나의
노드에 나무 가지와 같은 형태로 붙어있다.

### 2) 파일
바이트가 정렬된 문자열이다. 

### 3) 디렉토리
관련 파일을 모아두는 폴더에 비유 할 수 있음 하위 디렉토리라는 다른 디렉토리가 디렉토리에 들어갈 수 있으므로
중첩하여 경로를 구성할 수 있다.

### 4) 아이노드(inode)
접근 권한, 크기, 소유자, 생성 시간 같은 파일 관련 정보들은 파일 개념과 분리되어있으며 이런 정보들을 파일 메타데이터라고 한다.
이 정보는 파일과 별도로 존재하는 자료 구조에 저장하는데 이를 아이노드라고 한다.  index node의 줄임말이다.

## 3. VFS 객체와 자료구조
### 1) 슈퍼 블록 객체
### 2) 아이노드 객체
### 3) 덴트리 객체
### 4) 파일 객체

※ 추가 포스팅 예정



# 참고문헌
- 리눅스 커널 심층분석 (에이콘 임베디드 시스템프로그래밍 시리즈 33,  로버트 러브 저자(글) · 황정동 번역)
- [리눅스 커널 6.6.7 버전](https://www.kernel.org/pub/linux/kernel/v6.x/linux-6.6.7.tar.gz)
